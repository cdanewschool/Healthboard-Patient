<?xml version="1.0" encoding="utf-8"?>
<s:Application 
	xmlns:ASclasses="ASclasses.*"
	xmlns:autocomplete="external.flashcommander.components.*"
	xmlns:fx="http://ns.adobe.com/mxml/2009" 
	xmlns:s="library://ns.adobe.com/flex/spark" 
	xmlns:mx="library://ns.adobe.com/flex/mx" 
	xmlns:components="components.*"
	xmlns:fxg="components.fxg.*"
	xmlns:ns="calendar.mxml_views.*"
	xmlns:views="calendar.classes.views.*"
	xmlns:calendar="external.com.flexcalendar.components.calendar.*"
	xmlns:home="components.home.*"
	xmlns:plus="external.TabBarPlus.plus.*"
	xmlns:radarchart="fr.kapit.radarchart.*" xmlns:amcharts="http://www.amcharts.com/com_internal"
	xmlns:enhancedtitlewindow="external.collapsibleTitleWindow.components.enhancedtitlewindow.*"
	xmlns:general="components.general.*" 
	xmlns="*" xmlns:modules="modules.*"
	minWidth="1024" minHeight="600" width="100%" height="100%"
	fontFamily="myMyriad" skinClass="skins.general.backgroundGradient"
	initialize="{TextLineRecycler.textLineRecyclerEnabled = false;}" 
	creationComplete="init()" xmlns:models="models.*" xmlns:widgets="components.widgets.*" xmlns:views1="components.views.*" xmlns:modules1="components.modules.*">
	
	<fx:Script>
		<![CDATA[
			import models.modules.MedicationsModel;
			
			import util.DateFormatters;
		]]>
	</fx:Script>
	
	<!--	external actionscript includes 	-->
	<fx:Script source="ASfiles/home.as" />
	<fx:Script source="ASfiles/messages.as" />
	<fx:Script source="../../visualDashboardShared/src/sharedASfiles/messages.as" />
	
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	
	<fx:Style source="css/styles.css" />
	<fx:Style source="external/calendar/styles/skin.css"/>
	
	<!--	application states	-->
	<s:states>
		<s:State name="default" />
		<s:State name="loggedIn" />
		<s:State name="widgetView" />
		<s:State name="modCalendar" />
		<s:State name="modImmunizations" />
		<s:State name="modMessages" />
		<s:State name="modMedicalRecords" />
		<s:State name="modMedications" />
		<s:State name="modVitalSigns" />
		<s:State name="modEducationalResources" />
		<s:State name="modExercise" />
		<s:State name="modNutrition" />
		<s:State name="profile" />
	</s:states>
	
	<s:layout>
		<s:VerticalLayout horizontalAlign="center" />
	</s:layout>
	
	<views1:LoginView width="1024" includeIn="default" />
	
	<!--<mx:ApplicationControlBar id="dockedBar" includeIn="loggedIn" 
	dock="true" width="1024" borderVisible="false" dropShadowVisible="false" height="38" paddingLeft="0" paddingRight="0" fillColors="[0x999999,0xB3B3B3]" fillAlphas="[1,0]" cornerRadius="0" borderAlpha="0">
	<s:VGroup paddingLeft="27" paddingTop="-3">
	<comps:healthBoardLogoGray id="hbLogoGray" />
	</s:VGroup>
	
	<mx:Spacer width="100%" />				
	
	<s:HGroup paddingTop="0" paddingRight="23">
	<s:DropDownList selectedIndex="0" width="125" dropShadowVisible="false" contentBackgroundAlpha="0" focusAlpha="0" skinClass="skins.MyDropDownListSkin" fontFamily="myMyriad" fontWeight="bold" fontSize="12" color="0xAEDBE2"> 
	<mx:ArrayCollection>
	<fx:String>Isaac Goodman</fx:String>
	<fx:String>User Profile</fx:String>
	</mx:ArrayCollection>
	</s:DropDownList>
	
	<mx:LinkButton label="Logout" color="0xFFFFFF" textDecoration="underline" fontSize="11" skin="{null}" paddingTop="2" paddingLeft="9" />
	
	<s:HGroup paddingTop="3">
	<s:DropDownList dropShadowVisible="false" skinClass="skins.MyOptionsDropDownListSkin" width="17" fontFamily="myMyriad" fontSize="11"> 
	<mx:ArrayCollection>
	<fx:String>Button View</fx:String>
	<fx:String>Widget View</fx:String>
	</mx:ArrayCollection>
	</s:DropDownList>
	</s:HGroup>
	</s:HGroup>
	</mx:ApplicationControlBar>-->
	
	<s:VGroup includeIn="loggedIn, profile, widgetView, modCalendar, modImmunizations, modMessages, modMedicalRecords, modMedications, modVitalSigns, modEducationalResources, modExercise, modNutrition" width="1024" horizontalAlign="center">		
		<!-- HEADER -->
		<s:Group width="100%">
			<s:BorderContainer width="1024" height="38" borderAlpha="0">
				<s:layout>
					<s:HorizontalLayout paddingTop="6" />
				</s:layout>
				<s:backgroundFill>
					<s:LinearGradient rotation="270">
						<s:GradientEntry color="0xB3B3B3" alpha="0" ratio="0" />
						<s:GradientEntry color="0x999999" alpha="1" ratio="1" /> <!--ratio="0.8834"-->
					</s:LinearGradient>
				</s:backgroundFill>
				
				<s:VGroup paddingLeft="27" click="{currentState=controller.model.viewMode}" buttonMode="{currentState!=controller.model.viewMode}"><!--includeIn="loggedIn, widgetView, profile"-->
					<fxg:healthBoardLogoGray />
				</s:VGroup>
				
				<!--<s:HGroup alpha=".7" color="0xFFFFFF" includeIn="modMessages, modCalendar, modImmunizations, modMedicalRecords, modMedications, modVitalSigns, modEducationalResources, modExercise, modNutrition" verticalAlign="middle" paddingLeft="16" gap="-4" fontSize="12">
				<mx:LinkButton id="btnBreadcrumbHome" label="Home" textRollOverColor="0xFFFFFF" textSelectedColor="0xFFFFFF" skin="{null}" click="{currentState=Constants.STATE_LOGGED_IN}" rollOver="btnBreadcrumbHome.styleName='linkBtnUnderline';" rollOut="btnBreadcrumbHome.styleName='linkBtn';" />
				
				<s:Label text=">" paddingTop="2" />
				
				<s:Label id="lblBreadcrumbCategory" text.modMessages="Messages" text.modCalendar="Appointments" text.modImmunizations="Immunizations" text.modMedicalRecords="Medical Records" text.modMedications="Medications" fontWeight="bold" paddingTop="2" paddingLeft="10" />
				<mx:LinkButton id="btnBreadcrumbCategory" visible="false" includeInLayout="false"
				label.modMessages="Messages" label.modCalendar="Appointments" label.modImmunizations="Immunizations" label.modMedicalRecords="Medical Records" label.modMedications="Medications"
				click.modMessages="{showInboxMessages();}"
				textRollOverColor="0xFFFFFF" textSelectedColor="0xFFFFFF" skin="{null}"
				rollOver="btnBreadcrumbCategory.styleName='linkBtnUnderline';" rollOut="btnBreadcrumbCategory.styleName='linkBtn';" />
				
				<s:Label id="lblMarkerSubcategory" text=">" paddingTop="2" visible="false" />
				
				<s:Label id="lblBreadcrumbSubcategory" visible="false" fontWeight="bold" paddingTop="2" paddingLeft="10" />
				<mx:LinkButton id="btnBreadcrumbSubcategory" visible="false"
				textRollOverColor="0xFFFFFF" textSelectedColor="0xFFFFFF" skin="{null}" />--><!-- label.modMessages="Messages" label.modCalendar="Appointments" label.modImmunizations="Immunizations"-->
				<!--</s:HGroup>-->
				
				<mx:Spacer width="100%" />
				
				<!--<s:Button label="Start Task" color="0xFF0000" click="saveTaskTime()" />
				
				<mx:Spacer width="100%" />-->
				
				<s:HGroup paddingRight="14">
					<!--
					<s:DropDownList id="dropDownProfile" selectedIndex="0" width="125" dropShadowVisible="false" contentBackgroundAlpha="0" focusAlpha="0" skinClass="skins.general.MyDropDownListSkin" fontWeight="bold" fontSize="12" color="0xAEDBE2" rollOverColor="0x5E5E5D" selectionColor="0x5E5E5D" change="{dropDownProfile.selectedIndex == 1 ? currentState = 'profile' : currentState = 'loggedIn'}"> 
					<mx:ArrayCollection>
					<fx:String>Isaac Goodman</fx:String>
					<fx:String>User Profile</fx:String>
					</mx:ArrayCollection>
					</s:DropDownList>-->
					<mx:LinkButton id="btnProfile" label="{controller.model.fullname}" color="0xAEDBE2" textRollOverColor="0xAEDBE2" textSelectedColor="0xAEDBE2" skin="{null}" click="{currentState='profile'}" rollOver="btnProfile.styleName='linkBtnUnderline';" rollOut="btnProfile.styleName='linkBtn';" />
					
					<mx:LinkButton id="btnLogout" label="Logout" color="0xE6E6E6" textRollOverColor="0xE6E6E6" textSelectedColor="0xE6E6E6" skin="{null}" paddingLeft="1" click="{currentState='default'}" rollOver="btnLogout.styleName='linkBtnUnderline';" rollOut="btnLogout.styleName='linkBtn';" />
					
					<s:HGroup paddingTop="-6" paddingLeft="-9">
						<s:DropDownList id="dropDownView" dropShadowVisible="false" skinClass="skins.general.MyOptionsDropDownListSkin" color="0x074F72" rollOverColor="0xAEDBE2" selectionColor="0xAEDBE2" width="35" fontSize="12" change="dropDownView_changeHandler(event)"> 
							<mx:ArrayCollection>
								<fx:String>     Homepage Options</fx:String>
								<fx:String>     Type and Units</fx:String>
								<fx:String>     Notifications</fx:String>
							</mx:ArrayCollection>
						</s:DropDownList>
					</s:HGroup>
				</s:HGroup>
			</s:BorderContainer>
		</s:Group>
		
		<!-- HOME / BUTTON VIEW -->
		<s:HGroup id="home" paddingTop="59" includeIn="loggedIn">
			<s:TileGroup id="buttonsTileGroup" requestedColumnCount="5" horizontalGap="42" verticalGap="46" clipAndEnableScrolling="true">
				<mx:Button id="buttonMessages" upSkin="@Embed('images/messages.png')" overSkin="@Embed('images/messages_over.png')" downSkin="@Embed('images/messages_down.png')" click="{this.currentState='modMessages';}" mouseMove="buttonViewMoveHandler(event,imgMessages)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonMessages)" />
				<mx:Button id="buttonAppointments" upSkin="@Embed('images/appointments.png')" overSkin="@Embed('images/appointments_over.png')" downSkin="@Embed('images/appointments_down.png')" click="{this.currentState='modCalendar';}" mouseMove="buttonViewMoveHandler(event,imgAppointments)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonAppointments)" />
				<mx:Button id="buttonMedicalRecords" upSkin="@Embed('images/medicalRecords.png')" overSkin="@Embed('images/medicalRecords_over.png')" downSkin="@Embed('images/medicalRecords_down.png')" click="{controller.loadData( Constants.MEDICAL_RECORDS ); this.currentState='modMedicalRecords';}" mouseMove="buttonViewMoveHandler(event,imgMedicalRecords)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonMedicalRecords)" />
				<mx:Button id="buttonImmunizations" upSkin="@Embed('images/immunizations.png')" overSkin="@Embed('images/immunizations_over.png')" downSkin="@Embed('images/immunizations_down.png')" click="{controller.loadData( Constants.IMMUNIZATIONS ); this.currentState='modImmunizations';}" mouseMove="buttonViewMoveHandler(event,imgImmunizations)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonImmunizations)" />
				<mx:Button id="buttonVitalSigns" upSkin="@Embed('images/vitalSigns.png')" overSkin="@Embed('images/vitalSigns_over.png')" downSkin="@Embed('images/vitalSigns_down.png')" click="{this.currentState='modVitalSigns'}" mouseMove="buttonViewMoveHandler(event,imgVitalSigns)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonVitalSigns)" />
				<mx:Button id="buttonExercise" upSkin="@Embed('images/exercise.png')" overSkin="@Embed('images/exercise_over.png')" downSkin="@Embed('images/exercise_down.png')" click="{this.currentState='modExercise'}" mouseMove="buttonViewMoveHandler(event,imgExercise)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonExercise)" />
				<mx:Button id="buttonNutrition" upSkin="@Embed('images/nutrition.png')" overSkin="@Embed('images/nutrition_over.png')" downSkin="@Embed('images/nutrition_down.png')" click="{this.currentState='modNutrition'}" mouseMove="buttonViewMoveHandler(event,imgNutrition)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonNutrition)" />
				<mx:Button id="buttonEducationalResources" upSkin="@Embed('images/educationalResources.png')" overSkin="@Embed('images/educationalResources_over.png')" downSkin="@Embed('images/educationalResources_down.png')" click="{this.currentState='modEducationalResources'}" mouseMove="buttonViewMoveHandler(event,imgEducationalResources)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonEducationalResources)" />
				<mx:Button id="buttonCommunityGroup" upSkin="@Embed('images/communityGroup.png')" overSkin="@Embed('images/communityGroup_over.png')" downSkin="@Embed('images/communityGroup_down.png')" mouseMove="buttonViewMoveHandler(event,imgCommunityGroup)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonCommunityGroup)" />
				<mx:Button id="buttonMedications" upSkin="@Embed('images/medications.png')" overSkin="@Embed('images/medications_over.png')" downSkin="@Embed('images/medications_down.png')" click="{controller.loadData( Constants.MEDICATIONS ); this.currentState='modMedications';}" mouseMove="buttonViewMoveHandler(event,imgMedications)" dragEnter="buttonViewDragEnterHandler(event)" dragDrop="buttonViewDragDropHandler(event,buttonMedications)" />
			</s:TileGroup>
		</s:HGroup>
		
		<!-- HOME / WIDGET VIEW -->
		<s:HGroup includeIn="widgetView" paddingTop="15">
			
			<s:Scroller id="widgetScroller" height="728" width="1024" horizontalScrollPolicy="off">
				
				<s:VGroup id="widgetContent">
					
					<s:HGroup gap="22" paddingTop="11" paddingLeft="32" minHeight="591">
						
						<s:VGroup gap="17">
							
							<!-- see http://blog.9mmedia.com/?p=535 -->
							<enhancedtitlewindow:EnhancedTitleWindow 
								id="widgetMessages" width="305" title="{'Messages (' + getUnreadMessagesCount().substr(2,1) + ')'}" 
								collapsible="true" headerClickable="false" module="modMessages" 
								showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" 
								visible="{widgetMessagesOpen}" includeInLayout="{widgetMessagesOpen}">
								
								<enhancedtitlewindow:layout>
									<s:VerticalLayout paddingLeft="10" paddingTop="10" paddingRight="10" paddingBottom="10"/>
								</enhancedtitlewindow:layout>
								
								<mx:DataGrid 
									dataProvider="{acMessagesToDisplay}" creationComplete="showInboxMessages()" buttonMode="true"
									width="100%" itemClick="openMessage(event);"
									color="0xFFFFFF" verticalAlign="middle"
									selectable="false"
									headerHeight="0"
									borderVisible="false" verticalGridLines="false" horizontalGridLines="false" horizontalSeparatorSkin="{null}" alternatingItemColors="[0x3C3C3B,0x3C3C3B]"
									horizontalScrollPolicy="off" verticalScrollPolicy="off" rowCount="4" rowHeight="18">
									
									<mx:columns>
										<mx:DataGridColumn dataField="correspondent">
											<mx:itemRenderer>
												<fx:Component>
													<mx:HBox horizontalScrollPolicy="off" paddingTop="-3">
														<fx:Script>
															<![CDATA[
																private function showEllipsis():String {
																	return (data.subject.length <= 13) ? '' : '...';
																}
															]]>
														</fx:Script>
														<mx:HBox width="11" paddingTop="6">
															<s:Image source="@Embed('images/messagesUrgentSmall.png')" toolTip="Urgent" visible="{data.messages[data.messages.length - 1].urgency == 'Urgent'}" includeInLayout="{data.messages[data.messages.length - 1].urgency == 'Urgent'}" />
															<s:Image source="@Embed('images/messagesSomewhatUrgentSmall.png')" toolTip="Somewhat urgent" visible="{data.messages[data.messages.length - 1].urgency == 'Somewhat urgent'}" includeInLayout="{data.messages[data.messages.length - 1].urgency == 'Somewhat urgent'}" />
														</mx:HBox>
														<s:Label text="{outerDocument.displayTime(data.date, 'short')}" fontSize="12" width="62" color="0x868686" paddingTop="6" />
														<s:Label text="{data.correspondent}" color="0xFFFFFF" fontSize="12" width="90" fontWeight="{data.status == 'unread' ? 'bold' : 'normal'}" paddingTop="6" />
														<mx:LinkButton id="btnWidgetMessage" label="{data.subject.substr(0,13) + showEllipsis()}" fontSize="12" fontWeight="{data.status == 'unread' ? 'bold' : 'normal'}" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnWidgetMessage.styleName='linkBtnUnderline';}" rollOut="btnWidgetMessage.styleName='linkBtn';" paddingLeft="-3" />
													</mx:HBox>
												</fx:Component>
											</mx:itemRenderer>
										</mx:DataGridColumn>
									</mx:columns>
								</mx:DataGrid>
								
								<s:HGroup paddingLeft="20" paddingTop="-6" gap="2">
									<s:Label fontSize="12" color="0x868686" text="{'...plus ' + (acMessagesToDisplay.length - 4) + ' more ' + (acMessagesToDisplay.length == 5 ? 'message.' : 'messages.')}" visible="{acMessagesToDisplay.length > 4}" includeInLayout="{acMessagesToDisplay.length > 4}" paddingTop="6" />
									<mx:LinkButton id="btnWidgetAllMessages" label="View All »" fontSize="12" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnWidgetAllMessages.styleName='linkBtnUnderline';}" rollOut="btnWidgetAllMessages.styleName='linkBtn';" click="currentState='modMessages';" paddingLeft="-3" />
								</s:HGroup>
								
							</enhancedtitlewindow:EnhancedTitleWindow>
							
							<widgets:AppointmentsWidget
								id="widgetAppointments" width="305" title="Appointments (4)" 
								collapsible="true" headerClickable="false" module="modCalendar" 
								showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" 
								visible="{widgetAppointmentsOpen}" includeInLayout="{widgetAppointmentsOpen}" />
							
							<widgets:ImmunizationsWidget 
								id="widgetImmunizations" width="305" title="Immunizations (12)" 
								collapsible="true" headerClickable="false" showCloseButton="{widgetLibraryOpen}" displayWarning="true" 
								warningToolTip="Immunizations overdue" titleBarHeight="30" 
								module="modImmunizations" visible="{widgetImmunizationsOpen}" includeInLayout="{widgetImmunizationsOpen}" />	<!--title="{'Immunizations (' + immunizationsDueNumber + ')'}" (see comments on ArrayList below)-->
							
							<widgets:MedicalRecordsWidget 
								id="widgetMedicalRecords" width="305" title="Medical Records" 
								collapsible="true" headerClickable="false" module="modMedicalRecords" 
								showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" color="0xFFFFFF" 
								visible="{widgetMedicalRecordsOpen}" includeInLayout="{widgetMedicalRecordsOpen}" />
							
							<widgets:EducationalResourcesWidget 
								id="widgetEducationalResources" width="305" title="Educational Resources" 
								collapsible="true" headerClickable="false" module="modEducationalResources" 
								showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" 
								visible="{widgetEducationalResourcesOpen}" includeInLayout="{widgetEducationalResourcesOpen}" />
							
						</s:VGroup>
						
						<s:VGroup gap="17">
							
							<widgets:MedicationsWidget
								id="widgetMedications" width="633" title="Medications" collapsible="true" headerClickable="false" module="modMedications" 
								showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" creationComplete="controller.loadData( Constants.MEDICATIONS )" 
								visible="{widgetMedicationsOpen}" includeInLayout="{widgetMedicationsOpen}" />
								
							<s:HGroup gap="22">
								
								<s:VGroup gap="17">
									
									<widgets:NutritionWidget 
										id="widgetNutrition" width="305" 
										title="Nutrition" 
										collapsible="true" headerClickable="false" module="modNutrition" 
										showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" 
										visible="{widgetNutritionOpen}" includeInLayout="{widgetNutritionOpen}" 
										creationComplete="widgetNutrition.subtitle = DateFormatters.dateFormatterDay.format(new Date())" />
									
									<widgets:VitalSignsWidget
										id="widgetVitalSigns" width="305" title="Vital Signs" 
										collapsible="true" headerClickable="false" module="modVitalSigns" 
										showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" 
										visible="{widgetVitalSignsOpen}" includeInLayout="{widgetVitalSignsOpen}" />
									
								</s:VGroup>
								
								<widgets:ExerciseWidget 
									id="widgetExercise" width="305" 
									title="Exercise" 
									collapsible="true" headerClickable="false" module="modExercise" 
									showCloseButton="{widgetLibraryOpen}" titleBarHeight="30" 
									visible="{widgetExerciseOpen}" includeInLayout="{widgetExerciseOpen}" />
								
							</s:HGroup>
							
						</s:VGroup>
						
					</s:HGroup>
					
					<s:VGroup width="100%" horizontalAlign="right" paddingTop="{widgetLibraryOpen ? 0 : 106}">
						
						<mx:LinkButton id="btnWidgetTrigger" label="Widgets" icon="{widgetLibraryOpen ? widgetTriggerClose : widgetTriggerOpen}" labelPlacement="left" paddingRight="34" fontSize="12" color="0xFFFFFF" textRollOverColor="0xFFFFFF" textSelectedColor="0xFFFFFF" skin="{null}" rollOver="{btnWidgetTrigger.styleName='linkBtnUnderline';}" rollOut="btnWidgetTrigger.styleName='linkBtn';" click="{widgetLibraryOpen = !widgetLibraryOpen; widgetContent.verticalScrollPosition = widgetContent.height + 100;}" />
						
						<s:BorderContainer width="1024" height="100" visible="{widgetLibraryOpen}" includeInLayout="{widgetLibraryOpen}" borderAlpha=".2" borderColor="0xF2F2F2">
							
							<s:layout>
								<s:HorizontalLayout paddingTop="5" paddingLeft="55" gap="40" />
							</s:layout>
							
							<s:backgroundFill>
								<s:LinearGradient rotation="270">
									<s:GradientEntry color="0x000000" alpha="1" ratio="0" />
									<s:GradientEntry color="0x515151" alpha="1" ratio="1" /> <!--ratio="0.8834"-->
								</s:LinearGradient>
							</s:backgroundFill>
							
							<s:HGroup>
								
								<s:VGroup visible="{widgetMessagesOpen}" includeInLayout="{widgetMessagesOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryMessages.png')" />
									<s:Label text="Messages" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetMessagesOpen}" includeInLayout="{!widgetMessagesOpen}" horizontalAlign="center" gap="4" click="{widgetMessagesOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryMessages.png')" overSkin="@Embed('images/widgetLibraryMessagesOver.png')" downSkin="@Embed('images/widgetLibraryMessagesDown.png')" />
									<s:Label text="Messages" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetAppointmentsOpen}" includeInLayout="{widgetAppointmentsOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryAppointments.png')" />
									<s:Label text="Appointments" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetAppointmentsOpen}" includeInLayout="{!widgetAppointmentsOpen}" horizontalAlign="center" gap="4" click="{widgetAppointmentsOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryAppointments.png')" overSkin="@Embed('images/widgetLibraryAppointmentsOver.png')" downSkin="@Embed('images/widgetLibraryAppointmentsDown.png')" />
									<s:Label text="Appointments" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetMedicalRecordsOpen}" includeInLayout="{widgetMedicalRecordsOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryMedicalRecords.png')" />
									<s:Label text="Medical Records" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetMedicalRecordsOpen}" includeInLayout="{!widgetMedicalRecordsOpen}" horizontalAlign="center" gap="4" click="{widgetMedicalRecordsOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryMedicalRecords.png')" overSkin="@Embed('images/widgetLibraryMedicalRecordsOver.png')" downSkin="@Embed('images/widgetLibraryMedicalRecordsDown.png')" />
									<s:Label text="Medical Records" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetImmunizationsOpen}" includeInLayout="{widgetImmunizationsOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryImmunizations.png')" />
									<s:Label text="Immunizations" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetImmunizationsOpen}" includeInLayout="{!widgetImmunizationsOpen}" horizontalAlign="center" gap="4" click="{widgetImmunizationsOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryImmunizations.png')" overSkin="@Embed('images/widgetLibraryImmunizationsOver.png')" downSkin="@Embed('images/widgetLibraryImmunizationsDown.png')" />
									<s:Label text="Immunizations" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetVitalSignsOpen}" includeInLayout="{widgetVitalSignsOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryVitalSigns.png')" />
									<s:Label text="Vital Signs" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetVitalSignsOpen}" includeInLayout="{!widgetVitalSignsOpen}" horizontalAlign="center" gap="4" click="{widgetVitalSignsOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryVitalSigns.png')" overSkin="@Embed('images/widgetLibraryVitalSignsOver.png')" downSkin="@Embed('images/widgetLibraryVitalSignsDown.png')" />
									<s:Label text="Vital Signs" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetEducationalResourcesOpen}" includeInLayout="{widgetEducationalResourcesOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryEducationalResources.png')" />
									<s:Label text="{'Educational\nResources'}" textAlign="center" lineHeight="11" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetEducationalResourcesOpen}" includeInLayout="{!widgetEducationalResourcesOpen}" horizontalAlign="center" gap="4" click="{widgetEducationalResourcesOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryEducationalResources.png')" overSkin="@Embed('images/widgetLibraryEducationalResourcesOver.png')" downSkin="@Embed('images/widgetLibraryEducationalResourcesDown.png')" />
									<s:Label text="{'Educational\nResources'}" textAlign="center" lineHeight="11" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetExerciseOpen}" includeInLayout="{widgetExerciseOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryExercise.png')" />
									<s:Label text="Exercise" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetExerciseOpen}" includeInLayout="{!widgetExerciseOpen}" horizontalAlign="center" gap="4" click="{widgetExerciseOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryExercise.png')" overSkin="@Embed('images/widgetLibraryExerciseOver.png')" downSkin="@Embed('images/widgetLibraryExerciseDown.png')" />
									<s:Label text="Exercise" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetMedicationsOpen}" includeInLayout="{widgetMedicationsOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryMedications.png')" />
									<s:Label text="Medications" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetMedicationsOpen}" includeInLayout="{!widgetMedicationsOpen}" horizontalAlign="center" gap="4" click="{widgetMedicationsOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryMedications.png')" overSkin="@Embed('images/widgetLibraryMedicationsOver.png')" downSkin="@Embed('images/widgetLibraryMedicationsDown.png')" />
									<s:Label text="Medications" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
							<s:HGroup>
								<s:VGroup visible="{widgetNutritionOpen}" includeInLayout="{widgetNutritionOpen}" horizontalAlign="center" gap="4">
									<s:Image source="@Embed('images/widgetLibraryNutrition.png')" />
									<s:Label text="Nutrition" fontSize="11" color="0xFFFFFF" />
								</s:VGroup>
								<s:VGroup visible="{!widgetNutritionOpen}" includeInLayout="{!widgetNutritionOpen}" horizontalAlign="center" gap="4" click="{widgetNutritionOpen = true}" buttonMode="true">
									<mx:Button upSkin="@Embed('images/widgetLibraryNutrition.png')" overSkin="@Embed('images/widgetLibraryNutritionOver.png')" downSkin="@Embed('images/widgetLibraryNutritionDown.png')" />
									<s:Label text="Nutrition" fontSize="11" color="0x666666" fontStyle="italic" />
								</s:VGroup>
							</s:HGroup>
							
						</s:BorderContainer>
						
					</s:VGroup>
					
				</s:VGroup>
				
			</s:Scroller>
			
		</s:HGroup>
		<!--<mx:Grid includeIn="widgetView" horizontalGap="33" verticalGap="18" horizontalAlign="center" width="100%" paddingTop="40">
		<mx:GridRow>
		<mx:GridItem>
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsMessages}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsMessages">
		<s:NavigatorContent label="Messages">
		<s:TitleWindow id="messages" skinClass="skins.general.myHeaderlessTitleWindow" title="Messages" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenMessages.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		<mx:GridItem colSpan="2">
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsMedicalRecords}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsMedicalRecords">
		<s:NavigatorContent label="Medical Records">
		<s:TitleWindow id="medicalRecords" skinClass="skins.general.myHeaderlessTitleWindow" title="Medical Records" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenMedicalRecords.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		</mx:GridRow>
		<mx:GridRow>
		<mx:GridItem>
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsAppointments}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsAppointments">
		<s:NavigatorContent label="Appointments (2)">
		<s:TitleWindow id="appointments" skinClass="skins.general.myHeaderlessTitleWindow" title="Appointments" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenAppointments.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		<mx:GridItem>
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsExercise}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsExercise">
		<s:NavigatorContent label="Exercise">
		<s:TitleWindow id="exercise" skinClass="skins.general.myHeaderlessTitleWindow" title="Exercise" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenExercise.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		<mx:GridItem rowSpan="2">
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsVitals}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsVitals">
		<s:NavigatorContent label="Vitals">
		<s:TitleWindow id="vitals" skinClass="skins.general.myHeaderlessTitleWindow" title="Vitals" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenVitals.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		</mx:GridRow>
		<mx:GridRow>
		<mx:GridItem>
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsNutrition}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsNutrition">
		<s:NavigatorContent label="Nutrition">
		<s:TitleWindow id="nutrition" skinClass="skins.general.myHeaderlessTitleWindow" title="Nutrition" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenNutrition.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		<mx:GridItem>	
		<s:VGroup gap="0">
		<s:TabBar dataProvider="{vsImmunization}" skinClass="skins.home.myWidgetTabs" styleName="widgetTabTitle" />
		<mx:ViewStack id="vsImmunization">
		<s:NavigatorContent label="Immunization (1)">
		<s:TitleWindow id="immunization" skinClass="skins.general.myHeaderlessTitleWindow" backgroundColor="0x666666" backgroundAlpha="0.2" borderColor="0xF2F2F2" borderAlpha="0.2" dropShadowVisible="false">
		<mx:Image source="@Embed('images/screenImmunization.jpg')" />
		</s:TitleWindow>
		</s:NavigatorContent>
		</mx:ViewStack>
		</s:VGroup>
		</mx:GridItem>
		</mx:GridRow>
		</mx:Grid>-->
		
		<!-- USER PROFILE SCREEN -->
		<s:VGroup id="profile" paddingTop="35" width="100%" horizontalAlign="center" includeIn="profile">
			<home:userProfileForm 
				id="myProfileForm" skinClass="skins.general.myChromelessTitleWindow"
				width="980" height="681"
				title=" User Profile" backgroundColor="0x4A4A49" borderColor="0X898989" styleName="whiteBoldTitle" dropShadowVisible="false" chromeColor="#706F6F" />
		</s:VGroup>
		
		<!-- CALENDAR -->
		<modules:AppointmentsModule id="appointmentsModule" includeIn="modCalendar" width="976" paddingTop="10" />
		
		<!-- IMMUNIZATIONS -->
		<modules:ImmunizationsModule includeIn="modImmunizations" width="976" paddingTop="10" />
		
		<!-- MESSAGES -->
		<s:VGroup includeIn="modMessages" width="976" paddingTop="10">
			
			<s:HGroup verticalAlign="middle" width="100%" paddingBottom="10">
				
				<s:Image source="@Embed('images/btnHome.png')" click="this.currentState=controller.model.viewMode;" buttonMode="true" />
				<s:Label text="Messages" styleName="whiteBoldTitle" paddingLeft="13" />
				<s:Label text="▼" fontSize="10" color="0xFFFFFF" paddingTop="4" paddingLeft="5" />
				<s:Label text="You have" styleName="moduleSubtitleItalic" paddingLeft="30" />
				<s:Label id="lblMessagesNumber" text="{(getUnreadMessagesCount() == '') ? 'no' : getUnreadMessagesCount().substr(2,1)}" styleName="moduleSubtitleItalic moduleSubtitleNumber" /> <!--text="{immunizationsDueNumber}"-->
				<s:Label text="new messages." styleName="moduleSubtitleItalic" />
				<s:Spacer width="100%" />
				
				<s:HGroup gap="-1">
					<s:TextInput id="messagesSearch" text="Search messages" fontSize="10" fontStyle="italic" color="0x999999" height="24" paddingTop="5" click="{if(messagesSearch.text == 'Search messages') messagesSearch.text=''}" change="searchFilter()" />
					<s:Button styleName="searchButtonIcon" width="24" height="24" />
				</s:HGroup>	
				
			</s:HGroup>
			
			<s:HGroup width="100%">
				
				<s:VGroup width="100%" paddingTop="15" paddingLeft="7" gap="7" styleName="whiteText13">
					<s:Label text="MAILBOXES" styleName="greenBoldText" paddingLeft="-4" paddingBottom="3" />
					<mx:LinkButton id="btnInbox" label="{'Inbox'+getUnreadMessagesCount()}" click="showInboxMessages()" styleName="messageFolderSelected" />
					<mx:LinkButton id="btnDrafts" label="{'Drafts'+getDraftMessagesCount()}" click="showDraftMessages()" />
					<mx:LinkButton id="btnSent" label="Sent" click="showSentMessages()" />
					<mx:LinkButton id="btnTrash" label="Trash" click="showTrashMessages()" />
				</s:VGroup>
				
				<s:Group creationComplete="bar_initializeHandler()">
					<mx:ViewStack 
						id="viewStackMessages" 
						borderColor="0xBDBCBC" cornerRadius="2" backgroundColor="0x4A4A49" width="825" height="606" borderVisible="true" borderStyle="solid" x="0" y="22" creationPolicy="all"><!--change="updateBreadcrumb('messages')" -->
						
						<s:NavigatorContent id="mainBox" label="Inbox">
							
							<s:layout>
								<s:VerticalLayout gap="0" />
							</s:layout>
							
							<s:BorderContainer height="37" width="100%" backgroundColor="0x706F6F">
								
								<s:layout>
									<s:HorizontalLayout verticalAlign="middle" paddingLeft="10" paddingRight="9"/>
								</s:layout>
								
								<s:Button label="Delete" styleName="buttonText" height="24" enabled="{currentMainBox != 'Trash' ? areButtonsEnabled : areTrashButtonsEnabled}" click="deleteMultiple()" />
								<s:Button label="Mark Unread" styleName="buttonText" height="24" enabled="{currentMainBox != 'Trash' ? areButtonsEnabled : areTrashButtonsEnabled}" click="markUnread()" />
								
								<s:Spacer width="100%" />
								
								<s:Label text="{(dgMessages.dataProvider.length &lt;= 1 ? dgMessages.dataProvider.length : '1 - ' + dgMessages.dataProvider.length) + ' of ' + dgMessages.dataProvider.length}" color="0xFFFFFF" fontSize="11" />						
							</s:BorderContainer>
							
							<s:Line xFrom="0" xTo="822">
								<s:stroke>
									<s:SolidColorStroke color="#3F3E3D"/>
								</s:stroke>
							</s:Line>
							
							<s:HGroup width="100%" color="0xFFFFFF" fontSize="11" height="31" verticalAlign="middle" paddingLeft="13" paddingRight="19" paddingTop="-1">
								<s:Label text="Select:" paddingTop="2" />
								<mx:LinkButton id="btnSelectAll" label="All" enabled="{areOptionsEnabled}" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" paddingLeft="-5" paddingRight="-8" click="{select('all')}" rollOver="{if(areOptionsEnabled) btnSelectAll.styleName='linkBtnUnderline';}" rollOut="btnSelectAll.styleName='linkBtn';" />
								<s:Label text="," paddingTop="2" />
								<mx:LinkButton id="btnSelectRead" label="Read" enabled="{areOptionsEnabled}" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" paddingLeft="-6" paddingRight="-8" click="{select('read')}" rollOver="{if(areOptionsEnabled) btnSelectRead.styleName='linkBtnUnderline';}" rollOut="btnSelectRead.styleName='linkBtn';" />
								<s:Label text="," paddingTop="2" />
								<mx:LinkButton id="btnSelectNone" label="None" enabled="{areOptionsEnabled}" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" paddingLeft="-6" paddingRight="-8" click="{select('none')}" rollOver="{if(areOptionsEnabled) btnSelectNone.styleName='linkBtnUnderline';}" rollOut="btnSelectNone.styleName='linkBtn';" />
								<s:Spacer width="100%" />
								<s:Label id="lblSearchResults" visible="false" paddingTop="2" fontWeight="bold" maxWidth="362" maxDisplayedLines="1" />
								<mx:LinkButton id="btnClearSearch" label="(Clear)" visible="false" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" paddingLeft="-5" paddingRight="-8" click="clearSearch()" rollOver="btnClearSearch.styleName='linkBtnUnderline';" rollOut="btnClearSearch.styleName='linkBtn';" />
								<s:Spacer width="100%" />
								<s:Label text="Show:" paddingTop="2" />
								<mx:LinkButton id="btnShowAll" label="All" enabled="{areOptionsEnabled}" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" paddingLeft="-5" paddingRight="-8" click="showAll()" rollOver="{if(areOptionsEnabled) btnShowAll.styleName='linkBtnUnderline';}" rollOut="btnShowAll.styleName='linkBtn';" />
								<s:Label text="," paddingTop="2" />
								<mx:LinkButton id="btnShowUnread" label="Unread" enabled="{areOptionsEnabled}" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" paddingLeft="-6" paddingRight="-8" click="showUnread()" rollOver="{if(areOptionsEnabled) btnShowUnread.styleName='linkBtnUnderline';}" rollOut="btnShowUnread.styleName='linkBtn';" />
								<s:Label text="Sort by:" paddingLeft="18" paddingTop="2" paddingRight="-9" />
								<s:DropDownList id="dropDownMessageSort" enabled="{areOptionsEnabled}" selectedIndex="0" width="105" dropShadowVisible="false" contentBackgroundColor="0x4A4A49" rollOverColor="0x5E5E5D" selectionColor="0x5E5E5D" skinClass="skins.general.MyDropDownListSkin" color="0xAEDBE2" change="messageSort()"> 
									<mx:ArrayCollection>
										<fx:String>Date Received</fx:String>
										<fx:String>Sender</fx:String>
										<fx:String>Urgency Level</fx:String>
									</mx:ArrayCollection>
								</s:DropDownList>
							</s:HGroup>
							
							<s:Line xFrom="0" xTo="822">
								<s:stroke>
									<s:SolidColorStroke color="#7C7C7C"/>
								</s:stroke>
							</s:Line>
							
							<ASclasses:RowColorDataGrid 
								id="dgMessages" rowColorFunction="calcRowColor" dataProvider="{acMessagesToDisplay}" creationComplete="showInboxMessages()" buttonMode="true"
								itemClick="dgMessages_itemClickHandler(event)"
								width="100%" height="100%"
								color="0xFFFFFF" verticalAlign="middle"
								selectable="false"
								headerHeight="0"
								borderVisible="false" rowHeight="59" verticalGridLines="false" horizontalGridLines="true" horizontalGridLineColor="0x7C7C7C" horizontalSeparatorSkin="{null}" alternatingItemColors="[0x4A4A49,0x4A4A49]" rowCount="3"><!--itemClick="dgMessages_itemClickHandler(event)" selectionColor="0x4A4A49" rollOverColor="0x4A4A49" selectionColor="0x00ADEE" rollOverColor="0x286982"-->
								
								<!--INITIALLY KEPT THE DATAGRID SELECTABLE, ONLY SO I COULD CALL dgMessages.selectedItem WHEN DELETING A MESSAGE-->
								<ASclasses:columns> 
									<mx:DataGridColumn dataField="status" width="46">
										<mx:itemRenderer>
											<fx:Component>
												<mx:HBox horizontalAlign="center"><!--buttonMode="true" click="{outerDocument.viewMessage(data);}"-->
													<s:Image source="@Embed('images/messagesEnvelope.png')" toolTip="Unread" visible="{data.status == 'unread'}" includeInLayout="{data.status == 'unread'}" />
													<!--<s:Image source="@Embed('images/messagesRead.png')" toolTip="Read" visible="{data.status == 'read'}" includeInLayout="{data.status == 'read'}" />-->
													<s:Image source="@Embed('images/messagesReplied.png')" toolTip="Replied" visible="{data.status == 'replied'}" includeInLayout="{data.status == 'replied'}" />
												</mx:HBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
									<mx:DataGridColumn width="26">
										<mx:itemRenderer>
											<fx:Component>
												<mx:HBox paddingTop="-1"><!--buttonMode="true"-->		
													<!--<fx:Script>
													<![CDATA[
													protected function messageCheckbox_clickHandler(event:MouseEvent):void {
													var item:Object = outerDocument.dgMessages.selectedItem;
													var index:int = outerDocument.acMessages.getItemIndex(item);
													outerDocument.acMessages.removeItemAt(index);
													}															
													]]>
													</fx:Script>-->
													<s:CheckBox id="messageCheckbox" change="outerDocument.selectMultiple(data,messageCheckbox.selected)" selected="{outerDocument.areCheckboxesSelected || data.checkboxSelection}" /><!--click="outerDocument.messageCheckbox_clickHandler(event)"-->
												</mx:HBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
									<mx:DataGridColumn dataField="correspondent" width="132">
										<mx:itemRenderer>
											<fx:Component>		
												<mx:VBox height="59" verticalAlign="middle" verticalGap="3" paddingTop="6"><!--buttonMode="true" click="{outerDocument.viewMessage(data);}"-->
													<s:Label text="{data.correspondent}" color="0xAEDEE4" fontSize="13" fontWeight="{data.status == 'unread' ? 'bold' : 'normal'}" />
													<s:Label text="{outerDocument.displayTime(data.date)}" fontSize="11" />
												</mx:VBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
									<mx:DataGridColumn dataField="subject" width="588">
										<mx:itemRenderer>
											<fx:Component>
												<mx:HBox verticalAlign="middle" height="59" paddingTop="7"><!--buttonMode="true" click="{outerDocument.viewMessage(data);}"-->
													<fx:Script>
														<![CDATA[
															//import mx.controls.Alert;
															
															private function showNumberOfMessages():String {
																return (!data.isDraft) ? (data.messages.length == 1) ? '' : '(' + data.messages.length + ') ' : '(DRAFT SAVED) ';
															}
															//this function was added to ensure that the (nevermind :)
															/*private function showInitialTextWithoutLineBreaks(myData:Object):String {
															for(var i:uint = 0; i < 75; i++) {
															if(myData.messages[myData.messages.length - 1].text.charAt(i) == "\n") {
															break;
															}
															}
															return myData.messages[myData.messages.length - 1].text.substr(0,i) + ' ';
															}*/
															private function showEllipsis():String {
																return (data.messages[data.messages.length - 1].text.length <= 75) ? '' : '...';
															}
														]]>
													</fx:Script>
													<mx:HBox width="17" >
														<s:Image source="@Embed('images/messagesUrgent.png')" toolTip="Urgent" visible="{data.messages[data.messages.length - 1].urgency == 'Urgent'}" includeInLayout="{data.messages[data.messages.length - 1].urgency == 'Urgent'}" />
														<s:Image source="@Embed('images/messagesSomewhatUrgent.png')" toolTip="Somewhat urgent" visible="{data.messages[data.messages.length - 1].urgency == 'Somewhat urgent'}" includeInLayout="{data.messages[data.messages.length - 1].urgency == 'Somewhat urgent'}" />
													</mx:HBox>
													<mx:VBox verticalGap="3">
														<s:Label text="{showNumberOfMessages() + data.subject}" color="0xAEDEE4" fontSize="13" fontWeight="{data.status == 'unread' ? 'bold' : 'normal'}" />
														<s:Label text="{data.messages[data.messages.length - 1].text.substr(0,75) + showEllipsis()}" maxDisplayedLines="1" />
													</mx:VBox>
												</mx:HBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
									<mx:DataGridColumn>
										<mx:itemRenderer>
											<fx:Component>
												<mx:VBox>
													<!--<fx:Script>
													<![CDATA[
													protected function image1_clickHandler(event:MouseEvent):void {
													var item:Object = outerDocument.dgMessages.selectedItem;
													//outerDocument.acTrash.addItem(item);
													var index:int = outerDocument.acMessages.getItemIndex(item);
													outerDocument.acMessages.removeItemAt(index);
													}
													]]>
													</fx:Script>-->
													<s:Image source="@Embed('images/messagesDelete.png')" toolTip="Delete" /><!--buttonMode="true" click="image1_clickHandler(event)"-->
												</mx:VBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
								</ASclasses:columns> 
							</ASclasses:RowColorDataGrid>
							
							<mx:Text id="lblNoMessages" visible="false" includeInLayout="false" width="100%" textAlign="center" color="0xFFFFFF" fontSize="11" paddingTop="31"
									 htmlText="{'There are no matching search results for the requested search.&lt;br&gt;Please make sure all words are spelled correctly, or try different keywords.'}" />
							<mx:Text id="lblNoMessagesFolder" visible="false" includeInLayout="false" width="100%" textAlign="center" color="0xFFFFFF" fontSize="11" paddingTop="31"
									 text="There are no messages in this folder." />
							
						</s:NavigatorContent>
						
						<s:NavigatorContent icon="@Embed('images/messagesNew.png')">
							
						</s:NavigatorContent>
						
					</mx:ViewStack>
					
					<!--<mccuneControls:SuperTabBar id="tabsMessages" dataProvider="{viewStackMessages}" styleName="messagesTabs" color="0xFFFFFF" fontSize="11" fontWeight="bold" x="0" y="0" itemClick="tabsMessages_childIndexChangeHandler(event)" closePolicy="{SuperTab.CLOSE_NEVER}"/>-->
					<!--<s:TabBar id="tabsMessages" dataProvider="{viewStackMessages}" styleName="messagesTabs" skinClass="skins.messages.CustomTabBarSkin" x="0" y="0" change="tabbar1_changeHandler(event)" />-->
					<plus:TabBarPlus id="tabsMessages" gap="6" cornerRadius="4" styleName="messagesTabs" closePolicy="always" dataProvider="{viewStackMessages}" change="tabbar1_changeHandler(event)" />
					
				</s:Group>
				
			</s:HGroup>
			
		</s:VGroup>
		
		<!--MEDICAL RECORDS-->
		<modules:MedicalRecordsModule includeIn="modMedicalRecords" width="976" paddingTop="10" />
		
		<!--MEDICATIONS-->
		<modules:MedicationsModule includeIn="modMedications" width="976" paddingTop="10" />
		
		<!-- VITAL SIGNS -->
		<modules:VitalSignsModule includeIn="modVitalSigns" width="976" paddingTop="10" />
		
		<!-- EDUCATIONAL RESOURCES -->
		<modules1:EducationalResourcesModule id="educationalResourcesModule" includeIn="modEducationalResources" width="976" paddingTop="10" creationComplete="{stage.focus = null}" />
		
		<!--EXERCISE-->
		<modules:ExerciseModule includeIn="modExercise" width="976" paddingTop="10" />
		
		<!--NUTRITION-->
		<modules:NutritionModule includeIn="modNutrition" width="976" paddingTop="10" />
		
	</s:VGroup>
</s:Application>
